# 🎓 ICPC/CCPC 知识点总结与做题技巧

本文档总结了所有模板背后的核心知识点、适用场景、识别方法和做题技巧。

---

## 📁 一、数据结构

### 1.1 并查集家族

#### 基础并查集 (DSU)

**核心思想**：维护元素的连通性关系，支持合并和查询。

**关键技巧**：

- 路径压缩：`find(x)` 时将路径上所有点直接连到根
- 按秩合并：小树合并到大树上，保证树高度为 O(log n)

**识别方法**：

- 问题涉及"分组"、"连通"、"等价关系"
- 需要动态维护集合的合并
- 判断两个元素是否在同一集合

**常见应用**：

- 判断图的连通性
- Kruskal 最小生成树
- 离线查询的连通性问题

**注意事项**：

- 合并时要判断是否已经在同一集合
- 路径压缩后父子关系会改变，不能用于维护树结构

---

#### 带权并查集

**核心思想**：在并查集基础上，维护每个节点到根的"关系"或"权值"。

**适用场景**：

- 关系型问题：食物链、敌友关系
- 区间问题：维护区间的覆盖、染色
- 偏移量问题：维护相对位置

**识别方法**：

- 题目中有"相对关系"描述
- 需要根据已知关系推导新关系
- 出现"A 比 B 大多少"、"A 吃 B"等表述

**经典题型**：

- 食物链问题（三种关系）
- 种类并查集（扩展域法）
- 区间染色问题

---

#### 可撤销并查集

**核心思想**：支持撤销最近的合并操作。

**实现要点**：

- 不能用路径压缩（会破坏历史状态）
- 用栈记录每次合并的操作
- 撤销时恢复父节点和秩

**适用场景**：

- 需要回溯的问题
- 线段树分治
- 动态图连通性（支持删边）

---

### 1.2 线段树家族

#### 基础线段树

**核心思想**：将区间递归二分，用树形结构维护区间信息。

**时间复杂度**：

- 建树：O(n)
- 单点修改/查询：O(log n)
- 区间修改/查询：O(log n)

**识别方法**：

- 需要频繁的区间查询和修改
- 查询和修改操作可以拆分成子区间
- 区间信息可以合并（满足区间可加性）

**常见操作**：

- 区间求和、最值、GCD
- 区间加、乘、赋值（lazy tag）
- 区间覆盖、翻转

**注意事项**：

- lazy tag 的下传时机
- 多个 tag 的优先级和相互影响
- 边界情况：空区间、单点区间

---

#### 权值线段树（动态开点）

**核心思想**：以值域作为下标建树，统计每个值的出现次数。

**适用场景**：

- 求第 k 小/大
- 值域很大但元素个数不多
- 区间不同数的个数

**与树状数组对比**：

- 树状数组：只能维护前缀信息
- 线段树：可以维护任意区间信息

---

#### 主席树（可持久化线段树）

**核心思想**：保存线段树的历史版本，共享未修改的节点。

**空间复杂度**：O(n log n)（n 次修改）

**经典应用**：

- 静态区间第 k 小
- 区间不同数的个数
- 带修改的区间查询

**识别方法**：

- 需要查询历史版本
- 静态的区间第 k 小
- 可以离线但需要保留所有历史状态

**做题技巧**：

- 前缀和思想：`query(l, r) = query(r) - query(l-1)`
- 二分答案 + 主席树判定

---

#### 李超线段树

**核心思想**：维护一组直线，支持插入直线和查询某点的最大/最小值。

**适用场景**：

- 动态凸包（只支持插入）
- 斜率优化 DP
- 维护分段线性函数

**与凸包优化对比**：

- 李超树：支持在线，O(log n) 插入和查询
- 凸包：离线，O(log n) 查询但需要维护凸壳

---

### 1.3 树状数组 (Fenwick Tree)

**核心思想**：利用二进制特性，用树形结构维护前缀信息。

**优势**：

- 代码简短，常数小
- 空间复杂度 O(n)
- 容易实现多维情况

**局限性**：

- 只能维护前缀信息（可结合差分扩展）
- 不支持区间取 max/min（需要线段树）

**扩展应用**：

- 差分数组：区间修改 + 单点查询
- 二维树状数组：二维前缀和
- 树上树状数组：结合 DFS 序

---

### 1.4 分块

**核心思想**：将序列分成 √n 块，块内暴力，块间预处理。

**时间复杂度**：O(√n)

**适用场景**：

- 线段树做不了的复杂操作
- 需要灵活的区间操作
- 多种操作混合

**常见技巧**：

- 整块打标记，散块暴力重构
- 值域分块：优化数颜色问题
- 时间分块：优化带修改的询问

---

### 1.5 LCT (Link-Cut Tree)

**核心思想**：用 Splay Tree 维护树链，支持动态树的链操作。

**支持操作**：

- `link(u, v)`：连边
- `cut(u, v)`：断边
- `makeroot(x)`：换根
- 路径查询/修改

**适用场景**：

- 动态树问题（加边、删边）
- 动态维护森林的连通性
- 树上路径操作

**识别方法**：

- 题目明确说"动态树"
- 需要支持加边、删边
- 静态的树用 HLD 更简单

**注意事项**：

- LCT 维护的是有根树链
- `makeroot` 操作会翻转路径
- 需要 `access` 打通到根的路径

---

### 1.6 字符串数据结构

#### Trie (字典树)

**核心思想**：树形结构存储字符串集合，共享公共前缀。

**应用**：

- 字符串检索
- 前缀统计
- 01 Trie：维护异或最值

**做题技巧**：

- 01 Trie 从高位到低位建树
- 贪心选择：每层尽量选不同的位
- 可持久化：维护历史版本

---

#### 后缀自动机 (SAM)

**核心思想**：识别字符串所有子串的最小自动机。

**核心性质**：

- 节点数 ≤ 2n - 1
- 边数 ≤ 3n - 4
- 每个节点代表若干个 right 集合相同的子串

**应用**：

- 统计不同子串个数
- 子串出现次数
- 最长公共子串
- 多字符串匹配（GSAM）

**识别方法**：

- 问"有多少不同子串"
- 问"子串在多少个字符串中出现"
- 涉及所有子串的统计

---

#### 回文自动机 (PAM)

**核心思想**：识别字符串所有回文子串的自动机。

**应用**：

- 统计回文子串个数
- 本质不同回文串
- 回文串的出现次数

---

### 1.7 特殊数据结构

#### SOS DP (高维前缀和)

**核心思想**：对于每个集合，快速求其所有子集的信息和。

**复杂度**：O(n · 2^n)，优于暴力的 O(3^n)

**识别方法**：

- 状压 DP 中需要枚举子集
- 求 `sum over subsets`
- 多个集合的或/与/异或运算

**应用**：

- 子集卷积
- 状压 DP 优化
- 集合幂级数

---

#### 舞蹈链 (DLX)

**核心思想**：双向十字链表，支持快速删除和恢复。

**适用场景**：

- 精确覆盖问题
- 数独求解
- N 皇后问题

**识别方法**：

- 题目要求"恰好覆盖"
- 需要选择若干集合，使得每个元素恰好被选一次
- 搜索空间大但有强剪枝

---

## 🌐 二、图论

### 2.1 最短路算法

#### Dijkstra

**适用**：非负权图的单源最短路。

**复杂度**：O((n + m) log n)（优先队列优化）

**注意**：

- 不能处理负权边
- 稀疏图用邻接表
- 稠密图用邻接矩阵 + O(n²) 朴素版本

---

#### SPFA

**适用**：一般图的单源最短路（可以有负权边）。

**复杂度**：

- 平均 O(km)，k 为常数（约 2）
- 最坏 O(nm)（被卡）

**判负环**：记录入队次数，若某点入队 ≥ n 次则有负环。

---

#### Floyd

**适用**：多源最短路、传递闭包。

**复杂度**：O(n³)

**优化**：

- Bitset 优化：传递闭包降到 O(n³/64)
- 记录路径：dp[i][j][k] 表示中间点编号 ≤ k 的最短路

---

#### 01BFS

**适用**：边权只有 0 和 1 的图。

**核心**：用双端队列，0 边放队首，1 边放队尾。

**复杂度**：O(n + m)

**识别**：

- 边权为 0/1
- 可以转化为 0/1 的问题（如：向右免费，其他方向 +1）

---

### 2.2 生成树

#### 最小生成树 (Kruskal)

**核心**：边按权值排序，用并查集判断是否成环。

**时间**：O(m log m)

**变种**：

- 次小生成树
- 最小瓶颈生成树
- 度数限制的生成树

---

### 2.3 连通性

#### 强连通分量 (SCC - Tarjan)

**核心**：一次 DFS 找出所有强连通分量。

**应用**：

- 有向图缩点
- 2-SAT 问题
- 判断图的半连通性

**识别**：

- 有向图的连通性
- 需要缩点后建 DAG

---

#### 边双连通分量 (EBCC)

**核心**：找出所有的桥，桥分割出的连通块就是 EBCC。

**应用**：

- 边双连通图
- 圆方树（广义圆方树）

---

#### 点双连通分量 (Point-BCC)

**核心**：找出割点，以割点为界分割图。

**应用**：

- 圆方树
- 仙人掌图
- 块树

---

### 2.4 网络流

#### 最大流 (Dinic)

**复杂度**：O(n²m)，实际表现很好。

**识别**：

- 问"最大流量"、"最大匹配"
- 二分图匹配（转化为网络流）
- 最小割 = 最大流

**建模技巧**：

- 拆点：限制点的流量
- 分层：限制流经次数
- 费用流：在满足流量的同时优化费用

---

#### 最小费用最大流

**应用**：

- 带权二分图匹配（KM 算法）
- 最优方案选择
- 最小费用路径覆盖

**注意**：

- 用 SPFA 找增广路可能被卡
- Dijkstra + 势函数更快

---

### 2.5 树上问题

#### LCA (最近公共祖先)

**方法**：

1. 倍增：O(n log n) 预处理，O(log n) 查询
2. Tarjan：O(n + q)，离线
3. 转 RMQ：O(n log n) 或 O(n) 预处理，O(1) 查询

**扩展**：

- 树上距离：`dist(u, v) = dist(u) + dist(v) - 2 * dist(lca(u, v))`
- k 级祖先：倍增

---

#### 树链剖分 (HLD)

**核心**：将树划分成若干条重链，链上问题转化为区间问题。

**支持**：

- 路径查询/修改：O(log² n)
- 子树查询/修改：O(log n)

**识别**：

- 树上路径的复杂操作
- 需要线段树维护的树上问题

---

#### 虚树

**核心**：只保留关键点及其 LCA，建立虚树。

**应用**：

- 询问涉及 k 个关键点（k << n）
- 关键点上的树形 DP

**复杂度**：O(k log k)

---

#### DSU on Tree (树上启发式合并)

**核心**：先处理轻儿子并清空，最后处理重儿子并保留信息。

**复杂度**：O(n log n)

**识别**：

- 子树统计问题
- 不支持修改
- 询问之间相互独立

---

### 2.6 特殊图论

#### 2-SAT

**问题**：给定若干布尔变量和约束，判断是否有解。

**建图**：

- `x ∨ y`：`¬x → y, ¬y → x`
- `x → y`：`¬y → ¬x`

**求解**：Tarjan 找 SCC，判断 x 和 ¬x 是否在同一 SCC。

---

#### Prufer 序列

**核心**：n 个点的带标号树 ↔ 长度为 n-2 的序列。

**应用**：

- Cayley 定理：n 个点的带标号树有 n^(n-2) 个
- 度数序列计数
- 生成随机树

---

## 🔢 三、数学

### 3.1 数论

#### 扩展欧几里得 (ExGCD)

**用途**：

1. 求 ax + by = gcd(a, b) 的整数解
2. 求乘法逆元（a⁻¹ ≡ x (mod m)）
3. 中国剩余定理

---

#### 素数筛

**方法**：

1. 埃氏筛：O(n log log n)
2. 线性筛：O(n)
3. 杜教筛：O(n^(2/3))
4. Min_25 筛：O(n^(3/4) / log n)

**应用**：

- 预处理素数表
- 计算积性函数（φ, μ, σ 等）
- 大范围素数统计

---

#### BSGS (Baby-Step Giant-Step)

**问题**：求 a^x ≡ b (mod p)

**复杂度**：O(√p)

**扩展**：

- exBSGS：处理 gcd(a, p) ≠ 1
- 原根问题
- 高次剩余

---

#### Min_25 筛

**用途**：快速计算积性函数的前缀和。

**复杂度**：O(n^(3/4) / log n)

**适用**：

- 计算 Σ φ(i)
- 计算 Σ μ(i)
- 素数的 k 次方和

**识别**：

- n 很大（10¹² 以上）
- 要求积性函数的前缀和
- 函数在素数处容易计算

---

### 3.2 组合数学

#### NTT / FFT

**用途**：快速计算多项式乘法。

**复杂度**：O(n log n)

**应用**：

- 大整数乘法
- 生成函数
- 组合计数

---

#### 分治 NTT

**用途**：计算形如 `f[i] = Σ a[j] * f[i-j]` 的递推。

**复杂度**：O(n log² n)

**应用**：

- 多项式求逆
- 生成函数的乘积
- 树形 DP 卷积优化

---

#### 容斥原理

**核心**：`|A ∪ B| = |A| + |B| - |A ∩ B|`

**扩展**：多个集合的容斥、二项式反演。

**识别**：

- "至少"、"恰好"的转换
- 不同条件的计数
- 需要去重的计数

---

#### Lucas 定理

**用途**：计算 C(n, m) mod p（p 为素数）。

**复杂度**：O(p + log_p n)

**适用**：p 较小（≤ 10⁵），n 很大。

---

### 3.3 线性代数

#### 线性基

**用途**：

- 表示向量空间的一组基
- 求最大/最小异或和
- 判断某个数能否被表示

**性质**：

- 线性无关
- 可以表示所有能表示的数
- 大小 ≤ log max(a[i])

---

#### 高斯消元

**用途**：

- 解线性方程组
- 求矩阵的秩
- 求行列式

**复杂度**：O(n³)

---

#### 矩阵快速幂

**用途**：

- 加速线性递推
- 图的路径计数
- DP 转移的加速

**识别**：

- 递推式是线性的
- 需要求第 n 项（n 很大）

---

### 3.4 博弈论

#### SG 函数

**核心**：`SG(x) = mex{SG(y) | y 是 x 的后继}`

**Nim 游戏定理**：多个游戏的 SG 值异或和为 0 则后手必胜。

**识别**：

- 公平组合游戏
- 双人博弈
- 轮流操作，无法操作者输

---

## 📝 四、字符串

### KMP

**用途**：字符串匹配。

**核心**：next 数组，利用已匹配信息避免重复比较。

**复杂度**：O(n + m)

---

### Z 函数

**定义**：z[i] = s 与 s[i:] 的最长公共前缀长度。

**用途**：

- 字符串匹配
- 周期性判断
- 多模式匹配

---

### Manacher

**用途**：O(n) 求所有回文子串。

**核心**：利用已知回文串的对称性。

---

### AC 自动机

**用途**：多模式串匹配。

**核心**：Trie + fail 指针（类似 KMP）。

**应用**：

- 多个模式串的匹配
- 统计模式串出现次数
- DP 状态转移

---

## 🎯 五、做题技巧总结

### 5.1 思维技巧

#### 转化思想

- 正难则反：求"至少"转化为总数减去"至多"
- 补集思想：不满足条件的数量
- 容斥原理：多个条件的计数

#### 分类讨论

- 按奇偶性分类
- 按大小关系分类
- 按位置关系分类

#### 贪心策略

- 局部最优 → 全局最优
- 排序后贪心
- 优先队列辅助

---

### 5.2 算法选择

#### 看数据范围

- n ≤ 10：暴力、状压 DP
- n ≤ 100：O(n³)，Floyd、高斯消元
- n ≤ 1000：O(n²)，DP、图论
- n ≤ 10⁵：O(n log n)，排序、线段树
- n ≤ 10⁶：O(n)，线性算法、哈希
- n ≥ 10⁹：O(log n)，二分、数学

#### 看操作类型

- 区间查询 + 单点修改：树状数组
- 区间查询 + 区间修改：线段树
- 需要撤销：可撤销并查集、线段树分治
- 动态树：LCT

---

### 5.3 常见套路

#### 离线处理

- 莫队算法
- CDQ 分治
- 整体二分
- 扫描线

#### 转化为图论

- 状态转移 → DAG
- 关系型问题 → 二分图
- 覆盖问题 → 网络流

#### 数据结构维护

- 单调栈维护：最近更大/小元素
- 单调队列优化：滑动窗口 DP
- 线段树维护：区间最值、区间 GCD

---

### 5.4 调试技巧

1. **小数据测试**：手造小数据，逐步增大
2. **对拍**：写暴力解，随机数据对拍
3. **特殊情况**：边界、极端数据
4. **输出中间结果**：检查算法每步的正确性
5. **压力测试**：大数据、极端情况

---

## 📚 六、学习建议

### 6.1 按难度学习

**基础**（必须掌握）：

- 基础算法：排序、二分、贪心、DP
- 数据结构：并查集、线段树、树状数组
- 图论：最短路、最小生成树、拓扑排序
- 数学：GCD、素数、快速幂、组合数

**进阶**（区域赛银牌）：

- 高级数据结构：主席树、树链剖分、LCT
- 高级图论：网络流、2-SAT、强连通分量
- 字符串：KMP、AC 自动机、后缀数组
- 数学：NTT、莫比乌斯反演、Lucas 定理

**高级**（区域赛金牌）：

- 特殊数据结构：SOS DP、DLX、李超树
- 特殊算法：Min_25 筛、分治 NTT、Bitset 优化
- 复杂 DP：斜率优化、四边形不等式优化
- 高级字符串：SAM、PAM

---

### 6.2 刷题建议

1. **专题训练**：同类题目连续做，总结规律
2. **虚拟比赛**：模拟真实比赛环境
3. **补题**：每场比赛都要补完所有题
4. **总结**：记录模板、常见错误、解题思路
5. **复习**：定期回顾模板和经典题

---

**版本**：v1.0  
**最后更新**：2025-10-02  
**配合使用**：参考对应的 .cpp 模板文件
